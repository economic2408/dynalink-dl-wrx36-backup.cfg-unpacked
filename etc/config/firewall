
config defaults
	option syn_flood '1'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'REJECT'
	option disable_ipv6 '0'
	option drop_invalid '1'
	option _enabled '0'

config zone
	option name 'lan'
	option network 'lan'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config zone 'zone_wan'
	option name 'wan'
	list network 'wan'
	list network 'wan6'
	option output 'ACCEPT'
	option forward 'REJECT'
	option masq '1'
	option mtu_fix '1'
	option input 'ACCEPT'

config zone 'zone_wan_vlan'
	option name 'wan_vlan'
	list network 'tagv'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'REJECT'

config forwarding
	option src 'lan'
	option dest 'wan'

config rule
	option name 'Allow-DHCP-Renew'
	option src 'wan'
	option proto 'udp'
	option dest_port '68'
	option target 'ACCEPT'
	option family 'ipv4'

config rule
	option name 'Allow-Ping'
	option src 'wan'
	option proto 'icmp'
	option icmp_type 'echo-request'
	option family 'ipv4'
	option target 'ACCEPT'
	option enabled '1'

config rule
	option name 'Allow-DHCPv6'
	option src 'wan'
	option proto 'udp'
	option src_ip 'fe80::/10'
	option dest_ip 'fe80::/10'
	option dest_port '546'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-MLD-Input'
	option src 'wan'
	option proto 'icmp'
	list icmp_type '130/0'
	list icmp_type '131/0'
	list icmp_type '132/0'
	list icmp_type '143/0'
	option family 'ipv6'
	option target 'ACCEPT'
	option enabled '0'
	option _enabled '0'

config rule
	option name 'Allow-ICMPv6-Input'
	option src 'wan'
	option proto 'icmp'
	list icmp_type 'echo-reply'
	list icmp_type 'destination-unreachable'
	list icmp_type 'packet-too-big'
	list icmp_type 'time-exceeded'
	list icmp_type 'bad-header'
	list icmp_type 'unknown-header-type'
	list icmp_type 'router-solicitation'
	list icmp_type 'neighbour-solicitation'
	list icmp_type 'router-advertisement'
	list icmp_type 'neighbour-advertisement'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-ICMPv6-Ping-Wan'
	option src 'wan'
	option proto 'icmp'
	list icmp_type 'echo-request'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'
	option enabled '0'

config rule
	option name 'Allow-IPv6-TR'
	option src 'wan'
	option family 'ipv6'
	option target 'ACCEPT'
	option dest_port '7547'

config rule
	option name 'Allow-Ping-Forward-IPv6'
	option src 'wan'
	option dest '*'
	option proto 'icmp'
	list icmp_type 'echo-request'
	option limit '1000/sec'
	option family 'ipv6'
	option target 'ACCEPT'
	option enabled '0'

config rule
	option name 'Allow-IPv6-Input-for-gre-only'
	option src 'wan'
	option proto 'gre'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-ICMPv6-Input-Vlan'
	option src 'wan_vlan'
	option proto 'icmp'
	list icmp_type 'echo-reply'
	list icmp_type 'router-solicitation'
	list icmp_type 'neighbour-solicitation'
	list icmp_type 'router-advertisement'
	list icmp_type 'neighbour-advertisement'
	option family 'ipv6'
	option target 'ACCEPT'

config rule
	option name 'Allow-IPv6-Input-VLAN-GRE'
	option src 'wan_vlan'
	option proto 'gre'
	option family 'ipv6'
	option target 'ACCEPT'

config rule 'allow_pptp_control'
	option target 'ACCEPT'
	option src 'wan'
	option src_port '1723'
	option name 'PPTP-Control'
	option proto 'tcp'
	option enabled '0'

config rule 'allow_gre_control'
	option target 'ACCEPT'
	option src 'wan'
	option name 'PPTP-GRE-Control'
	option proto 'gre'
	option enabled '0'

config rule 'pptpd_rule'
	option target 'ACCEPT'
	option name 'pptpd'
	option family 'IPv4'
	option src 'wan'
	option proto 'tcp'
	option dest_port '1723'
	option enabled '0'

config rule 'pptpd_rule_1'
	option target 'ACCEPT'
	option name 'gre'
	option src 'wan'
	option proto '47'
	option enabled '0'

config include 'pptpd_include'
	option type 'script'
	option path '/etc/ppp/firewall.pptpd'
	option family 'IPv4'
	option enabled '0'

config rule 'igmp_control'
	option name 'igmp_control'
	option src 'wan'
	option proto 'igmp'
	option target 'ACCEPT'
	option family 'IPv4'

config rule 'mld_control'
	option name 'mld_control'
	option src 'wan'
	option proto 'udp'
	option dest_ip 'ff00::/8'
	option target 'ACCEPT'
	option family 'IPv6'

config rule 'multicast_udp_control'
	option name 'multicast_udp_control'
	option _enabled '0'
	option src 'wan'
	option proto 'udp'
	option dest '*'
	option dest_ip '224.0.0.0/4'
	option family 'IPv4'
	option target 'ACCEPT'

config rule 'multicast_udpip6_control'
	option name 'multicast_udpip6_control'
	option _enabled '0'
	option src 'wan'
	option proto 'udp'
	option dest '*'
	option dest_ip 'ff00::/8'
	option target 'DROP'
	option family 'IPv6'

config rule 'Allow_RIP'
	option src 'wan'
	option proto 'udp'
	option src_port '520'
	option dest_port '520'
	option target 'ACCEPT'
	option enabled '0'

config rule 'Allow_RIPNG'
	option src 'wan'
	option proto 'udp'
	option src_port '521'
	option dest_port '521'
	option target 'ACCEPT'
	option family 'ipv6'
	option enabled '0'

config rule 'Allow_PIM'
	option src 'wan'
	option proto 'pim'
	option target 'ACCEPT'
	option family 'ipv4'
	option enabled '0'

config rule 'Allow_PIM_IPv6'
	option src 'wan'
	option proto 'pim'
	option target 'ACCEPT'
	option family 'ipv6'
	option enabled '0'

config rule 'Allow_NORM'
	option src 'wan'
	option proto 'udp'
	option src_port '7001-7002'
	option target 'ACCEPT'
	option enabled '1'

config include
	option path '/etc/firewall.user'
	option reload '1'

config redirect 'wanhttpacs'
	option src 'wan'
	option src_dport '8080'
	option proto 'tcp'
	option dest 'lan'
	option dest_port '80'
	option enabled '0'

config redirect 'wanhttpsacs'
	option src 'wan'
	option src_dport '8443'
	option proto 'tcp'
	option dest 'lan'
	option dest_port '443'
	option enabled '0'

config zone 'zone_commtap'
	option name 'commtap'
	option network 'commtap'
	option input 'ACCEPT'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config include 'httpredirectrule'
	option type 'script'
	option path '/etc/firewall.d/http-redirect-rule'

config redirect 'dynamic_nat_lan0'
	option name 'Dynamic NAT LAN'
	option src 'lan'
	option src_ip '192.168.1.0/24'
	option proto 'all'
	option dest 'wan'
	option target 'SNAT'
	option enabled '0'

config redirect 'dynamic_nat_lan1'
	option name 'Dynamic NAT LAN1'
	option src 'lan1'
	option src_ip '192.168.2.0/24'
	option proto 'all'
	option dest 'wan'
	option target 'SNAT'
	option enabled '0'

config redirect 'dynamic_nat_lan2'
	option name 'Dynamic NAT LAN2'
	option src 'lan2'
	option src_ip '192.168.3.0/24'
	option proto 'all'
	option dest 'wan'
	option target 'SNAT'
	option enabled '0'

config redirect 'dynamic_nat_lan3'
	option name 'Dynamic NAT LAN3'
	option src 'lan3'
	option src_ip '192.168.4.0/24'
	option proto 'all'
	option dest 'wan'
	option target 'SNAT'
	option enabled '0'

config zone 'lan1'
	option name 'lan1'
	option network 'lan1'
	option input 'DROP'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config forwarding 'lan1towan'
	option src 'lan1'
	option dest 'wan'

config rule 'lan1_dns_proxy'
	option src 'lan1'
	option dest_port '53'
	option proto 'udp'
	option target 'ACCEPT'
	option family 'ipv4'

config rule 'lan1_dhcp_renew'
	option name 'Allow-DHCP-Renew'
	option src_port '68'
	option src 'lan1'
	option proto 'udp'
	option target 'ACCEPT'
	option family 'ipv4'

config zone 'lan2'
	option name 'lan2'
	option network 'lan2'
	option input 'DROP'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config forwarding 'lan2towan'
	option src 'lan2'
	option dest 'wan'

config rule 'lan2_dns_proxy'
	option src 'lan2'
	option dest_port '53'
	option proto 'udp'
	option target 'ACCEPT'
	option family 'ipv4'

config rule 'lan2_dhcp_renew'
	option name 'Allow-DHCP-Renew'
	option src_port '68'
	option src 'lan2'
	option proto 'udp'
	option target 'ACCEPT'
	option family 'ipv4'

config zone 'lan3'
	option name 'lan3'
	option network 'lan3'
	option input 'DROP'
	option output 'ACCEPT'
	option forward 'ACCEPT'

config forwarding 'lan3towan'
	option src 'lan3'
	option dest 'wan'

config rule 'lan3_dns_proxy'
	option src 'lan3'
	option dest_port '53'
	option proto 'udp'
	option target 'ACCEPT'
	option family 'ipv4'

config rule 'lan3_dhcp_renew'
	option name 'Allow-DHCP-Renew'
	option src_port '68'
	option src 'lan3'
	option proto 'udp'
	option target 'ACCEPT'
	option family 'ipv4'

config rule 'refuse_lan_to_lan1'
	option name 'refuse pkg from lan to lan1'
	option src 'lan'
	option dest_ip '192.168.2.1'
	option target 'drop'
	option enabled '0'

config rule 'refuse_lan_to_lan2'
	option name 'refuse pkg from lan to lan2'
	option src 'lan'
	option dest_ip '192.168.3.1'
	option target 'drop'
	option enabled '0'

config rule 'refuse_lan_to_lan3'
	option name 'refuse pkg from lan to lan3'
	option src 'lan'
	option dest_ip '192.168.4.1'
	option target 'drop'
	option enabled '0'

config rule 'lan1_igmp_control'
	option name 'lan1_igmp_control'
	option src 'lan1'
	option proto 'igmp'
	option target 'ACCEPT'
	option enabled '1'
	option family 'IPv4'

config rule 'lan2_igmp_control'
	option name 'lan2_igmp_control'
	option src 'lan2'
	option proto 'igmp'
	option target 'ACCEPT'
	option enabled '0'
	option family 'IPv4'

config rule 'lan3_igmp_control'
	option name 'lan3_igmp_control'
	option src 'lan3'
	option proto 'igmp'
	option target 'ACCEPT'
	option enabled '0'
	option family 'IPv4'

config rule 'Allow_tcp_ports'
	option src 'lan'
	option proto 'tcp'
	option dest_port '53 80 139 443 445 1723 2601 4422 5000 22345'
	option target 'ACCEPT'

config rule 'Block_all_ports'
	option src 'lan'
	option proto 'tcp'
	option target 'drop'

config include 'miniupnpd'
	option type 'script'
	option path '/usr/share/miniupnpd/firewall.include'
	option family 'any'
	option reload '1'

config include 'qcanssecm'
	option type 'script'
	option path '/etc/firewall.d/qca-nss-ecm'
	option family 'any'
	option reload '1'

config include 'dhcp_snooping'
	option path '/etc/firewall.dhcpsnooping'

config include 'swifisolicit'
	option path '/etc/firewall.swifisolicit'

config include
	option path '/etc/firewall.askeyspwifi'
	option reload '1'

